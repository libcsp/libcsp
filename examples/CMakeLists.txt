if(CMAKE_SYSTEM_NAME STREQUAL "Linux")
  if(CSP_BUILD_EXAMPLES)
    add_executable(csp_server_client csp_server_client.c csp_server_client_posix.c)
    add_executable(csp_server csp_server.c csp_server_posix.c)
    add_executable(csp_client csp_client.c csp_client_posix.c)
  else()
    add_executable(csp_server_client EXCLUDE_FROM_ALL csp_server_client.c csp_server_client_posix.c)
    add_executable(csp_server EXCLUDE_FROM_ALL csp_server.c csp_server_posix.c)
    add_executable(csp_client EXCLUDE_FROM_ALL csp_client.c csp_client_posix.c)
  endif()
  target_link_libraries(csp_server_client PRIVATE csp Threads::Threads)
  target_link_libraries(csp_server PRIVATE csp Threads::Threads)
  target_link_libraries(csp_client PRIVATE csp Threads::Threads)
endif()

add_executable(csp_arch EXCLUDE_FROM_ALL csp_arch.c)
target_link_libraries(csp_arch PRIVATE csp)

if(CMAKE_SYSTEM_NAME STREQUAL "Linux")
  add_executable(zmqproxy EXCLUDE_FROM_ALL zmqproxy.c)
  target_include_directories(zmqproxy PRIVATE ${csp_inc} ${LIBZMQ_INCLUDE_DIRS})
  target_link_libraries(zmqproxy PRIVATE csp Threads::Threads ${LIBZMQ_LIBRARIES})
endif()
